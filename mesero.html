<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Mesero - El Enkanto</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@4.0.0/fonts/remixicon.css">
    <link rel="stylesheet" href="mesero.css">
    <style>
        input, select, textarea { font-size: 16px !important; }
        @supports (padding: max(0px)) {
            body { padding-left: max(1rem, env(safe-area-inset-left)); padding-right: max(1rem, env(safe-area-inset-right)); }
        }
    </style>
</head>
<body>
    <header class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <i class="ri-restaurant-2-line"></i>
                <span>El Enkanto - Mesero</span>
            </div>
            <div class="navbar-stats">
                <div class="stat-item">
                    <span class="stat-label">Mesa</span>
                    <span class="stat-value" id="current-mesa">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Platos</span>
                    <span class="stat-value" id="cart-count">0</span>
                </div>
            </div>
            <div class="navbar-center">
                <button class="btn-status" id="btn-ver-pedidos" onclick="viewMesaOrders()" style="display: none;" title="Ver mis pedidos">
                    <i class="ri-receipt-2-line"></i>
                    <span>Mi Seguimiento</span>
                </button>
            </div>
            <div class="navbar-actions">
                <a href="admin.html" class="btn-nav" title="Ir a Admin">
                    <i class="ri-settings-line"></i>
                    <span>Admin</span>
                </a>
                <a href="cocina.html" class="btn-nav" title="Ir a Cocina">
                    <i class="ri-restaurant-line"></i>
                    <span>Cocina</span>
                </a>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="all-orders-panel">
            <h3><i class="ri-receipt-list-line"></i> Estado de Todos los Pedidos</h3>
            <div class="all-orders-container">
                <div class="orders-column all-pending">
                    <div class="orders-header-small">
                        <span><i class="ri-time-line"></i> Pendiente</span>
                        <span class="count-badge" id="count-all-pending">0</span>
                    </div>
                    <div class="orders-list-small" id="orders-all-pending">
                        <div class="empty-small">‚Äî</div>
                    </div>
                </div>

                <div class="orders-column all-preparing">
                    <div class="orders-header-small">
                        <span><i class="ri-flashlight-line"></i> Preparando</span>
                        <span class="count-badge" id="count-all-preparing">0</span>
                    </div>
                    <div class="orders-list-small" id="orders-all-preparing">
                        <div class="empty-small">‚Äî</div>
                    </div>
                </div>

                <div class="orders-column all-ready">
                    <div class="orders-header-small">
                        <span><i class="ri-check-double-line"></i> Listo</span>
                        <span class="count-badge" id="count-all-ready">0</span>
                    </div>
                    <div class="orders-list-small" id="orders-all-ready">
                        <div class="empty-small">‚Äî</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="step-section" id="step-mesa">
            <div class="section-header">
                <h2><i class="ri-door-line"></i> Selecciona la Mesa</h2>
                <p class="section-subtitle">Elige la mesa donde est√°s atendiendo</p>
            </div>
            
            <div class="mesas-grid" id="mesas-container">
                <!-- Mesas generadas din√°micamente -->
            </div>

            <button class="btn btn-secondary" onclick="resetSelection()">
                <i class="ri-refresh-line"></i> Cambiar Mesa
            </button>
        </section>
            </div>
        </section>

        <section class="step-section hidden" id="step-menu">
            <div class="section-header">
                <h2><i class="ri-book-line"></i> Men√∫ - Mesa <span id="mesa-title">0</span></h2>
                <p class="section-subtitle">Selecciona los platos para el cliente</p>
            </div>

            <div class="filters">
                <button class="filter-btn active" data-category="todas">Todas</button>
                <button class="filter-btn" data-category="Entrada">ü•ó Entrada</button>
                <button class="filter-btn" data-category="Plato Principal">üçΩÔ∏è Principal</button>
                <button class="filter-btn" data-category="Bebida">ü•§ Bebida</button>
                <button class="filter-btn" data-category="Postre">üç∞ Postre</button>
                <button class="filter-btn" data-category="Otro">üì¶ Otro</button>
            </div>

            <div class="productos-grid" id="productos-container">
                <!-- Productos generados din√°micamente -->
            </div>

            <div class="menu-actions">
                <button class="btn btn-secondary" onclick="resetSelection()">
                    <i class="ri-arrow-left-line"></i> Cambiar Mesa
                </button>
                <button class="btn btn-primary" id="cart-button" onclick="showCart()" style="display: none;">
                    <i class="ri-shopping-cart-line"></i> Ver Carrito (<span id="cart-badge">0</span>)
                </button>
            </div>
        </section>

        <section class="step-section hidden" id="step-carrito">
            <div class="section-header">
                <h2><i class="ri-shopping-cart-line"></i> Tu Pedido - Mesa <span id="mesa-carrito">0</span></h2>
                <p class="section-subtitle">Revisa antes de enviar a cocina</p>
            </div>

            <div class="carrito-items" id="carrito-items">
                <!-- Items del carrito generados din√°micamente -->
            </div>

            <div class="carrito-actions">
                <button class="btn btn-secondary" onclick="backToMenu()">
                    <i class="ri-arrow-left-line"></i> Agregar M√°s
                </button>
                <button class="btn btn-primary" onclick="sendOrder()">
                    <i class="ri-send-plane-line"></i> Enviar a Cocina
                </button>
            </div>
        </section>

        <section class="step-section hidden" id="step-ordenes">
            <div class="section-header">
                <h2><i class="ri-receipt-2-line"></i> Mis Pedidos - Mesa <span id="mesa-ordenes">0</span></h2>
                <p class="section-subtitle">Estado de tus √≥rdenes en cocina</p>
            </div>

            <div class="ordenes-container">
                <div class="ordenes-column ordenes-pending">
                    <div class="ordenes-header">
                        <h3><i class="ri-time-line"></i> Pendiente</h3>
                        <span class="ordenes-count" id="count-mesa-pending">0</span>
                    </div>
                    <div class="ordenes-list" id="ordenes-pending">
                        <div class="empty-state-small">Sin pedidos</div>
                    </div>
                </div>

                <div class="ordenes-column ordenes-preparing">
                    <div class="ordenes-header">
                        <h3><i class="ri-flashlight-line"></i> Preparando</h3>
                        <span class="ordenes-count" id="count-mesa-preparing">0</span>
                    </div>
                    <div class="ordenes-list" id="ordenes-preparing">
                        <div class="empty-state-small">Sin pedidos</div>
                    </div>
                </div>

                <div class="ordenes-column ordenes-ready">
                    <div class="ordenes-header">
                        <h3><i class="ri-check-double-line"></i> Listo</h3>
                        <span class="ordenes-count" id="count-mesa-ready">0</span>
                    </div>
                    <div class="ordenes-list" id="ordenes-ready">
                        <div class="empty-state-small">Sin pedidos</div>
                    </div>
                </div>
            </div>

            <div class="carrito-actions">
                <button class="btn btn-secondary" onclick="goBackToMesa()">
                    <i class="ri-arrow-left-line"></i> Volver a Seleccionar Mesa
                </button>
                <button class="btn btn-primary" onclick="newOrder()">
                    <i class="ri-shopping-cart-line"></i> Nuevo Pedido
                </button>
            </div>
        </section>
    </main>

    <div id="notification" class="toast" role="alert" aria-live="polite">
        <div class="toast-content">
            <i class="ri-check-line"></i>
            <span id="toast-message">Mensaje</span>
        </div>
    </div>

    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner-container">
            <div class="spinner"></div>
            <p>Procesando...</p>
        </div>
    </div>

    <script src="mesero.js"></script>
</body>
</html>
